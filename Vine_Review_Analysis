{"cells":[{"cell_type":"code","source":["import os\n","# Find the latest version of spark 3.0 from http://www.apache.org/dist/spark/ and enter as the spark version\n","# For example:\n","# spark_version = 'spark-3.0.3'\n","spark_version = 'spark-3.0.3'\n","os.environ['SPARK_VERSION']=spark_version\n","\n","# Install Spark and Java\n","!apt-get update\n","!apt-get install openjdk-11-jdk-headless -qq > /dev/null\n","!wget -q http://www.apache.org/dist/spark/$SPARK_VERSION/$SPARK_VERSION-bin-hadoop2.7.tgz\n","!tar xf $SPARK_VERSION-bin-hadoop2.7.tgz\n","!pip install -q findspark\n","\n","# Set Environment Variables\n","import os\n","os.environ[\"JAVA_HOME\"] = \"/usr/lib/jvm/java-11-openjdk-amd64\"\n","os.environ[\"SPARK_HOME\"] = f\"/content/{spark_version}-bin-hadoop2.7\"\n","\n","# Start a SparkSession\n","import findspark\n","findspark.init()"],"metadata":{"id":"8pSDWKqjEiGN","executionInfo":{"status":"ok","timestamp":1645146271783,"user_tz":360,"elapsed":24909,"user":{"displayName":"John Johnson","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhstUkqtfEw5JoEhfpH0QisWPDpqPm_xx1h5ha0hg=s64","userId":"10615251833365899961"}},"outputId":"ab47cde8-129e-479d-a171-7d2e5623081a","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["\r0% [Working]\r            \rGet:1 https://cloud.r-project.org/bin/linux/ubuntu bionic-cran40/ InRelease [3,626 B]\n","\r0% [Waiting for headers] [Waiting for headers] [1 InRelease 0 B/3,626 B 0%] [Wa\r0% [Waiting for headers] [Waiting for headers] [Waiting for headers] [Waiting f\r                                                                               \rIgn:2 https://developer.download.nvidia.com/compute/cuda/repos/ubuntu1804/x86_64  InRelease\n","\r0% [Waiting for headers] [Waiting for headers] [Waiting for headers] [Waiting f\r0% [1 InRelease gpgv 3,626 B] [Waiting for headers] [Waiting for headers] [Wait\r                                                                               \rGet:3 http://security.ubuntu.com/ubuntu bionic-security InRelease [88.7 kB]\n","\r0% [1 InRelease gpgv 3,626 B] [Waiting for headers] [3 InRelease 14.2 kB/88.7 k\r                                                                               \rGet:4 http://ppa.launchpad.net/c2d4u.team/c2d4u4.0+/ubuntu bionic InRelease [15.9 kB]\n","\r0% [1 InRelease gpgv 3,626 B] [Waiting for headers] [3 InRelease 14.2 kB/88.7 k\r                                                                               \rHit:5 http://archive.ubuntu.com/ubuntu bionic InRelease\n","\r0% [1 InRelease gpgv 3,626 B] [3 InRelease 14.2 kB/88.7 kB 16%] [4 InRelease 11\r                                                                               \rIgn:6 https://developer.download.nvidia.com/compute/machine-learning/repos/ubuntu1804/x86_64  InRelease\n","Get:7 https://developer.download.nvidia.com/compute/cuda/repos/ubuntu1804/x86_64  Release [696 B]\n","Hit:8 https://developer.download.nvidia.com/compute/machine-learning/repos/ubuntu1804/x86_64  Release\n","Get:9 https://developer.download.nvidia.com/compute/cuda/repos/ubuntu1804/x86_64  Release.gpg [836 B]\n","Get:10 http://archive.ubuntu.com/ubuntu bionic-updates InRelease [88.7 kB]\n","Hit:11 http://ppa.launchpad.net/cran/libgit2/ubuntu bionic InRelease\n","Get:12 http://ppa.launchpad.net/deadsnakes/ppa/ubuntu bionic InRelease [15.9 kB]\n","Get:13 http://archive.ubuntu.com/ubuntu bionic-backports InRelease [74.6 kB]\n","Get:14 http://ppa.launchpad.net/graphics-drivers/ppa/ubuntu bionic InRelease [21.3 kB]\n","Get:16 http://ppa.launchpad.net/c2d4u.team/c2d4u4.0+/ubuntu bionic/main Sources [1,826 kB]\n","Get:17 https://developer.download.nvidia.com/compute/cuda/repos/ubuntu1804/x86_64  Packages [917 kB]\n","Get:18 http://security.ubuntu.com/ubuntu bionic-security/multiverse amd64 Packages [21.1 kB]\n","Get:19 http://security.ubuntu.com/ubuntu bionic-security/main amd64 Packages [2,564 kB]\n","Get:20 http://ppa.launchpad.net/c2d4u.team/c2d4u4.0+/ubuntu bionic/main amd64 Packages [936 kB]\n","Get:21 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 Packages [3,004 kB]\n","Get:22 http://security.ubuntu.com/ubuntu bionic-security/universe amd64 Packages [1,470 kB]\n","Get:23 http://security.ubuntu.com/ubuntu bionic-security/restricted amd64 Packages [783 kB]\n","Get:24 http://archive.ubuntu.com/ubuntu bionic-updates/restricted amd64 Packages [816 kB]\n","Get:25 http://archive.ubuntu.com/ubuntu bionic-updates/multiverse amd64 Packages [29.0 kB]\n","Get:26 http://archive.ubuntu.com/ubuntu bionic-updates/universe amd64 Packages [2,248 kB]\n","Get:27 http://ppa.launchpad.net/deadsnakes/ppa/ubuntu bionic/main amd64 Packages [45.3 kB]\n","Get:28 http://ppa.launchpad.net/graphics-drivers/ppa/ubuntu bionic/main amd64 Packages [42.8 kB]\n","Fetched 15.0 MB in 4s (3,856 kB/s)\n","Reading package lists... Done\n"]}]},{"cell_type":"code","source":["from pyspark.sql import SparkSession\n","spark = SparkSession.builder.appName('Vine_Review_Analysis').getOrCreate()"],"metadata":{"id":"5Qomy84lE6iz"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from pyspark import SparkFiles\n","url = \"https://s3.amazonaws.com/amazon-reviews-pds/tsv/amazon_reviews_us_Wireless_v1_00.tsv.gz\"\n","spark.sparkContext.addFile(url)\n","df = spark.read.option(\"encoding\", \"UTF-8\").csv(SparkFiles.get(\"amazon_reviews_us_Wireless_v1_00.tsv.gz\"), sep=\"\\t\", header=True, inferSchema=True)\n","df.show()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"8GN8Jjt7XgOr","executionInfo":{"status":"ok","timestamp":1645146672063,"user_tz":360,"elapsed":124595,"user":{"displayName":"John Johnson","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhstUkqtfEw5JoEhfpH0QisWPDpqPm_xx1h5ha0hg=s64","userId":"10615251833365899961"}},"outputId":"c1df048b-6459-46aa-bd50-d08103bd0a16"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["+-----------+-----------+--------------+----------+--------------+--------------------+----------------+-----------+-------------+-----------+----+-----------------+--------------------+--------------------+-----------+\n","|marketplace|customer_id|     review_id|product_id|product_parent|       product_title|product_category|star_rating|helpful_votes|total_votes|vine|verified_purchase|     review_headline|         review_body|review_date|\n","+-----------+-----------+--------------+----------+--------------+--------------------+----------------+-----------+-------------+-----------+----+-----------------+--------------------+--------------------+-----------+\n","|         US|   16414143|R3W4P9UBGNGH1U|B00YL0EKWE|     852431543|LG G4 Case Hard T...|        Wireless|          2|            1|          3|   N|                Y|Looks good, funct...|2 issues  -  Once...| 2015-08-31|\n","|         US|   50800750|R15V54KBMTQWAY|B00XK95RPQ|     516894650|Selfie Stick Fibl...|        Wireless|          4|            0|          0|   N|                N| A fun little gadget|I’m embarrassed t...| 2015-08-31|\n","|         US|   15184378| RY8I449HNXSVF|B00SXRXUKO|     984297154|Tribe AB40 Water ...|        Wireless|          5|            0|          0|   N|                Y|          Five Stars|  Fits iPhone 6 well| 2015-08-31|\n","|         US|   10203548|R18TLJYCKJFLSR|B009V5X1CE|     279912704|RAVPower® Element...|        Wireless|          5|            0|          0|   N|                Y|       Great charger|Great charger.  I...| 2015-08-31|\n","|         US|     488280|R1NK26SWS53B8Q|B00D93OVF0|     662791300|Fosmon Micro USB ...|        Wireless|          5|            0|          0|   N|                Y|          Five Stars|Great for the pri...| 2015-08-31|\n","|         US|   13334021|R11LOHEDYJALTN|B00XVGJMDQ|     421688488|iPhone 6 Case, Vo...|        Wireless|          5|            0|          0|   N|                Y|          Five Stars|Great Case, bette...| 2015-08-31|\n","|         US|   27520697|R3ALQVQB2P9LA7|B00KQW1X1C|     554285554|Nokia Lumia 630 R...|        Wireless|          4|            0|          0|   N|                Y|          Four Stars|Easy to set up an...| 2015-08-31|\n","|         US|   48086021|R3MWLXLNO21PDQ|B00IP1MQNK|     488006702|Lumsing 10400mah ...|        Wireless|          5|            0|          0|   N|                Y|          Five Stars|         Works great| 2015-08-31|\n","|         US|   12738196|R2L15IS24CX0LI|B00HVORET8|     389677711|iPhone 5S Battery...|        Wireless|          5|            0|          0|   N|                Y|      So far so good|So far so good. I...| 2015-08-31|\n","|         US|   15867807|R1DJ8976WPWVZU|B00HX3G6J6|     299654876|HTC One M8 Screen...|        Wireless|          3|            0|          0|   N|                Y|seems durable but...|seems durable but...| 2015-08-31|\n","|         US|    1972249|R3MRWNNR8CBTB7|B00U4NATNQ|     577878727|S6 Case - Bear Mo...|        Wireless|          5|            0|          0|   N|                Y|Super thin, light...|Super thin, light...| 2015-08-31|\n","|         US|   10956619|R1DS6DKTUXAQK3|B00SZEFDH8|     654620704|BLU Studio X, Unl...|        Wireless|          5|            0|          0|   N|                Y|          Five Stars|As good as the Sa...| 2015-08-31|\n","|         US|   14805911| RWJM5E0TWUJD2|B00JRJUL9U|     391166958|EZOPower 5-Port U...|        Wireless|          5|            0|          0|   N|                Y|            EZOPower|I received this o...| 2015-08-31|\n","|         US|   15611116|R1XTJKDYNCRGAC|B00KQ4T0HE|     481551630|iPhone 6S Case &i...|        Wireless|          1|            0|          0|   N|                Y|Very cheap case. ...|Very cheap case. ...| 2015-08-31|\n","|         US|   39298603|R2UZL3DPWEU1XW|B00M0YWKPM|     685107474| iPhone 6s Plus Case|        Wireless|          5|            0|          0|   N|                Y|          Five Stars|       son loves it.| 2015-08-31|\n","|         US|   17552454|R2EZXET9KBFFU3|B00KDZEE68|     148320945|zBoost ZB575-A TR...|        Wireless|          1|            0|          0|   N|                Y|            One Star|you have to turn ...| 2015-08-31|\n","|         US|   12218556|R26VY1L1FD3LPU|B00BJN45GM|      47788188|OtterBox Defender...|        Wireless|          5|            0|          0|   N|                Y|          Five Stars|  Awesome, thank you| 2015-08-31|\n","|         US|   21872923|R2SSA4NSFCV18T|B00SA86SXW|     748759272|Aduro PowerUP 30W...|        Wireless|          5|            0|          0|   N|                N|          Five Stars|         nice, smart| 2015-08-31|\n","|         US|   16264332|R1G6333JHJNEUQ|B00Q3I68TU|     974085141|LilGadgets Connec...|        Wireless|          5|            0|          0|   N|                Y|Great headphones ...|We love these hea...| 2015-08-31|\n","|         US|    6042304|R2DRG0UZXJQ0PE|B00TN4J1TA|     716174627|Anker Aluminum Mu...|        Wireless|          5|            0|          0|   N|                Y|          Five Stars|This is well wort...| 2015-08-31|\n","+-----------+-----------+--------------+----------+--------------+--------------------+----------------+-----------+-------------+-----------+----+-----------------+--------------------+--------------------+-----------+\n","only showing top 20 rows\n","\n"]}]},{"cell_type":"code","source":["vine_df = df.select(['review_id', 'star_rating', 'helpful_votes', 'total_votes', 'vine', 'verified_purchase'])\n","vine_df.show()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ukOSq0r4Yo5N","executionInfo":{"status":"ok","timestamp":1645146715648,"user_tz":360,"elapsed":588,"user":{"displayName":"John Johnson","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhstUkqtfEw5JoEhfpH0QisWPDpqPm_xx1h5ha0hg=s64","userId":"10615251833365899961"}},"outputId":"f4d26c87-aef8-4af0-a89a-156acdbb1ff1"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["+--------------+-----------+-------------+-----------+----+-----------------+\n","|     review_id|star_rating|helpful_votes|total_votes|vine|verified_purchase|\n","+--------------+-----------+-------------+-----------+----+-----------------+\n","|R3W4P9UBGNGH1U|          2|            1|          3|   N|                Y|\n","|R15V54KBMTQWAY|          4|            0|          0|   N|                N|\n","| RY8I449HNXSVF|          5|            0|          0|   N|                Y|\n","|R18TLJYCKJFLSR|          5|            0|          0|   N|                Y|\n","|R1NK26SWS53B8Q|          5|            0|          0|   N|                Y|\n","|R11LOHEDYJALTN|          5|            0|          0|   N|                Y|\n","|R3ALQVQB2P9LA7|          4|            0|          0|   N|                Y|\n","|R3MWLXLNO21PDQ|          5|            0|          0|   N|                Y|\n","|R2L15IS24CX0LI|          5|            0|          0|   N|                Y|\n","|R1DJ8976WPWVZU|          3|            0|          0|   N|                Y|\n","|R3MRWNNR8CBTB7|          5|            0|          0|   N|                Y|\n","|R1DS6DKTUXAQK3|          5|            0|          0|   N|                Y|\n","| RWJM5E0TWUJD2|          5|            0|          0|   N|                Y|\n","|R1XTJKDYNCRGAC|          1|            0|          0|   N|                Y|\n","|R2UZL3DPWEU1XW|          5|            0|          0|   N|                Y|\n","|R2EZXET9KBFFU3|          1|            0|          0|   N|                Y|\n","|R26VY1L1FD3LPU|          5|            0|          0|   N|                Y|\n","|R2SSA4NSFCV18T|          5|            0|          0|   N|                N|\n","|R1G6333JHJNEUQ|          5|            0|          0|   N|                Y|\n","|R2DRG0UZXJQ0PE|          5|            0|          0|   N|                Y|\n","+--------------+-----------+-------------+-----------+----+-----------------+\n","only showing top 20 rows\n","\n"]}]},{"cell_type":"code","source":["filtered_df = vine_df.filter(vine_df['total_votes'] > 20)\n","filtered_df.show()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"SeZBwtCqYtyn","executionInfo":{"status":"ok","timestamp":1645146738106,"user_tz":360,"elapsed":688,"user":{"displayName":"John Johnson","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhstUkqtfEw5JoEhfpH0QisWPDpqPm_xx1h5ha0hg=s64","userId":"10615251833365899961"}},"outputId":"525539cd-aa0b-4208-8056-553867e1bfd7"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["+--------------+-----------+-------------+-----------+----+-----------------+\n","|     review_id|star_rating|helpful_votes|total_votes|vine|verified_purchase|\n","+--------------+-----------+-------------+-----------+----+-----------------+\n","|R2WOW0TURNXB26|          3|           54|         59|   N|                Y|\n","|R13VL62Y2HBQ0B|          5|           15|         21|   N|                Y|\n","|R22G55KAPZKJQV|          4|           20|         21|   N|                Y|\n","|R1610PGTJS7G3N|          2|           28|         44|   N|                Y|\n","| RLQL04BL0QXOJ|          4|           45|         47|   N|                Y|\n","|R2AYJHH8WJNGAU|          4|           98|        104|   N|                Y|\n","|R111DJA10Y6CMU|          5|           26|         39|   N|                Y|\n","|R2EE2TR4MRDV0U|          5|           53|         59|   N|                Y|\n","| RD4A80I5JDHED|          5|           69|         77|   N|                N|\n","|R1GU6IYZQWQE8X|          2|           24|         25|   N|                Y|\n","| RZOPM62JMW97V|          2|          103|        108|   N|                Y|\n","|R21GLR3TD27ISV|          3|            4|         22|   N|                Y|\n","|R1D3NR5GREEXXJ|          5|           57|         58|   N|                Y|\n","|R24BMEHX5EWGEY|          2|           26|         30|   N|                Y|\n","|R2WYKBQS8OR08O|          5|          168|        176|   N|                Y|\n","|R3DL0Y1KWYLD5X|          5|           36|         37|   N|                Y|\n","|R3EGDTFDMCOOG4|          5|           74|         90|   N|                N|\n","|R1MC93W6WG9R3O|          1|           22|         22|   N|                Y|\n","|R35B0B69DYR54L|          1|           18|         22|   N|                Y|\n","|R1593EM56412NH|          4|           33|         37|   N|                Y|\n","+--------------+-----------+-------------+-----------+----+-----------------+\n","only showing top 20 rows\n","\n"]}]},{"cell_type":"code","source":["helpful_df = filtered_df.filter((filtered_df['helpful_votes']/filtered_df['total_votes']) >= 0.5)\n","helpful_df.show()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"IGOiErUZYzun","executionInfo":{"status":"ok","timestamp":1645146771316,"user_tz":360,"elapsed":674,"user":{"displayName":"John Johnson","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhstUkqtfEw5JoEhfpH0QisWPDpqPm_xx1h5ha0hg=s64","userId":"10615251833365899961"}},"outputId":"4230e1b7-36c2-48c5-8d86-3ad238844f13"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["+--------------+-----------+-------------+-----------+----+-----------------+\n","|     review_id|star_rating|helpful_votes|total_votes|vine|verified_purchase|\n","+--------------+-----------+-------------+-----------+----+-----------------+\n","|R2WOW0TURNXB26|          3|           54|         59|   N|                Y|\n","|R13VL62Y2HBQ0B|          5|           15|         21|   N|                Y|\n","|R22G55KAPZKJQV|          4|           20|         21|   N|                Y|\n","|R1610PGTJS7G3N|          2|           28|         44|   N|                Y|\n","| RLQL04BL0QXOJ|          4|           45|         47|   N|                Y|\n","|R2AYJHH8WJNGAU|          4|           98|        104|   N|                Y|\n","|R111DJA10Y6CMU|          5|           26|         39|   N|                Y|\n","|R2EE2TR4MRDV0U|          5|           53|         59|   N|                Y|\n","| RD4A80I5JDHED|          5|           69|         77|   N|                N|\n","|R1GU6IYZQWQE8X|          2|           24|         25|   N|                Y|\n","| RZOPM62JMW97V|          2|          103|        108|   N|                Y|\n","|R1D3NR5GREEXXJ|          5|           57|         58|   N|                Y|\n","|R24BMEHX5EWGEY|          2|           26|         30|   N|                Y|\n","|R2WYKBQS8OR08O|          5|          168|        176|   N|                Y|\n","|R3DL0Y1KWYLD5X|          5|           36|         37|   N|                Y|\n","|R3EGDTFDMCOOG4|          5|           74|         90|   N|                N|\n","|R1MC93W6WG9R3O|          1|           22|         22|   N|                Y|\n","|R35B0B69DYR54L|          1|           18|         22|   N|                Y|\n","|R1593EM56412NH|          4|           33|         37|   N|                Y|\n","|R1KEP1DUJK2LD5|          5|           34|         42|   N|                Y|\n","+--------------+-----------+-------------+-----------+----+-----------------+\n","only showing top 20 rows\n","\n"]}]},{"cell_type":"code","source":["paid_review_df = helpful_df.filter(helpful_df['vine'] == 'Y')\n","paid_review_df.show()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"wfwyMFswY_Rj","executionInfo":{"status":"ok","timestamp":1645146820891,"user_tz":360,"elapsed":3965,"user":{"displayName":"John Johnson","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhstUkqtfEw5JoEhfpH0QisWPDpqPm_xx1h5ha0hg=s64","userId":"10615251833365899961"}},"outputId":"77eb7fd2-709e-4c5f-8b25-fe8d387b950b"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["+--------------+-----------+-------------+-----------+----+-----------------+\n","|     review_id|star_rating|helpful_votes|total_votes|vine|verified_purchase|\n","+--------------+-----------+-------------+-----------+----+-----------------+\n","|R1MAOLI5FJHAFM|          4|          249|        261|   Y|                N|\n","| R9PYAUDIBJVEC|          4|           12|         22|   Y|                N|\n","| R6V9SHMMG5M8F|          5|          101|        110|   Y|                N|\n","|R37PVLT6ELL5J4|          4|          181|        209|   Y|                N|\n","| R2FSFGWZF24V9|          4|           50|         51|   Y|                N|\n","|R3SRW1E8J56IGV|          5|          262|        281|   Y|                N|\n","| R86Z11D4CWOFM|          4|           32|         36|   Y|                N|\n","| RNP01HW9YISJO|          4|           20|         23|   Y|                N|\n","|R3KLACA6LCDZ0S|          3|           21|         22|   Y|                N|\n","| RZEQYOT2RE0N7|          4|           75|         80|   Y|                N|\n","|R2WBPX441TH495|          5|          202|        221|   Y|                N|\n","|R2BYBSYHS66ZN8|          5|          109|        114|   Y|                N|\n","|R3IF59PJGCNU3Q|          4|           42|         54|   Y|                N|\n","|R2IXC6U7W4OCQ9|          5|          185|        201|   Y|                N|\n","|R1JEI3H9QRP6PH|          5|           15|         22|   Y|                N|\n","|R37L3KGRRR6JTL|          3|           38|         47|   Y|                N|\n","|R1YJ7OKAEML92P|          5|           20|         22|   Y|                N|\n","|R3JZJOD2512UVY|          4|           85|        101|   Y|                N|\n","|R38MY3TK17MXDH|          4|           25|         32|   Y|                N|\n","|R2LWISZ4DSM0I4|          5|           28|         33|   Y|                N|\n","+--------------+-----------+-------------+-----------+----+-----------------+\n","only showing top 20 rows\n","\n"]}]},{"cell_type":"code","source":["unpaid_review_df = helpful_df.filter(helpful_df['vine'] == 'N')\n","unpaid_review_df.show()\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2zeVfUJlZLbV","executionInfo":{"status":"ok","timestamp":1645146864754,"user_tz":360,"elapsed":317,"user":{"displayName":"John Johnson","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhstUkqtfEw5JoEhfpH0QisWPDpqPm_xx1h5ha0hg=s64","userId":"10615251833365899961"}},"outputId":"8b6ede7f-4397-4f17-ea14-b4ca52008c28"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["+--------------+-----------+-------------+-----------+----+-----------------+\n","|     review_id|star_rating|helpful_votes|total_votes|vine|verified_purchase|\n","+--------------+-----------+-------------+-----------+----+-----------------+\n","|R2WOW0TURNXB26|          3|           54|         59|   N|                Y|\n","|R13VL62Y2HBQ0B|          5|           15|         21|   N|                Y|\n","|R22G55KAPZKJQV|          4|           20|         21|   N|                Y|\n","|R1610PGTJS7G3N|          2|           28|         44|   N|                Y|\n","| RLQL04BL0QXOJ|          4|           45|         47|   N|                Y|\n","|R2AYJHH8WJNGAU|          4|           98|        104|   N|                Y|\n","|R111DJA10Y6CMU|          5|           26|         39|   N|                Y|\n","|R2EE2TR4MRDV0U|          5|           53|         59|   N|                Y|\n","| RD4A80I5JDHED|          5|           69|         77|   N|                N|\n","|R1GU6IYZQWQE8X|          2|           24|         25|   N|                Y|\n","| RZOPM62JMW97V|          2|          103|        108|   N|                Y|\n","|R1D3NR5GREEXXJ|          5|           57|         58|   N|                Y|\n","|R24BMEHX5EWGEY|          2|           26|         30|   N|                Y|\n","|R2WYKBQS8OR08O|          5|          168|        176|   N|                Y|\n","|R3DL0Y1KWYLD5X|          5|           36|         37|   N|                Y|\n","|R3EGDTFDMCOOG4|          5|           74|         90|   N|                N|\n","|R1MC93W6WG9R3O|          1|           22|         22|   N|                Y|\n","|R35B0B69DYR54L|          1|           18|         22|   N|                Y|\n","|R1593EM56412NH|          4|           33|         37|   N|                Y|\n","|R1KEP1DUJK2LD5|          5|           34|         42|   N|                Y|\n","+--------------+-----------+-------------+-----------+----+-----------------+\n","only showing top 20 rows\n","\n"]}]},{"cell_type":"code","source":["total_reviews = paid_review_df.count() + unpaid_review_df.count()\n","print(f'There are {total_reviews} total reviews')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"TmsAoEKCZQ9e","executionInfo":{"status":"ok","timestamp":1645147069989,"user_tz":360,"elapsed":96238,"user":{"displayName":"John Johnson","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhstUkqtfEw5JoEhfpH0QisWPDpqPm_xx1h5ha0hg=s64","userId":"10615251833365899961"}},"outputId":"fad66252-5bd8-488a-8947-d3c3da9c3e37"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["There are 61724 total reviews\n"]}]},{"cell_type":"code","source":["paid_review_count = paid_review_df.count()\n","unpaid_review_count = unpaid_review_df.count()\n","print(f'There are {paid_review_count} paid reviews and {unpaid_review_count} unpaid reviews.')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"3IimWkb0aK3a","executionInfo":{"status":"ok","timestamp":1645147213408,"user_tz":360,"elapsed":95044,"user":{"displayName":"John Johnson","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhstUkqtfEw5JoEhfpH0QisWPDpqPm_xx1h5ha0hg=s64","userId":"10615251833365899961"}},"outputId":"d98c2ab5-88b1-43a7-8e0a-9b2832f0e3c3"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["There are 585 paid reviews and 61139 unpaid reviews.\n"]}]},{"cell_type":"code","source":["five_star_paid_review_count = paid_review_df.filter(paid_review_df['star_rating'] == 5).count()\n","five_star_unpaid_review_count = unpaid_review_df.filter(unpaid_review_df['star_rating'] == 5).count()\n","print(f'There are {five_star_paid_review_count} 5 Star paid reviews and {five_star_unpaid_review_count} 5 Star unpaid reviews.')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"1dAYvVTlan8a","executionInfo":{"status":"ok","timestamp":1645147433453,"user_tz":360,"elapsed":98231,"user":{"displayName":"John Johnson","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhstUkqtfEw5JoEhfpH0QisWPDpqPm_xx1h5ha0hg=s64","userId":"10615251833365899961"}},"outputId":"5928e188-72a6-43df-9f21-a12f8f38459a"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["There are 213 5 Star paid reviews and 28839 5 Star unpaid reviews.\n"]}]},{"cell_type":"code","source":["paid_percent_five_review = (five_star_paid_review_count / paid_review_count) * 100\n","unpaid_percent_five_review = (five_star_unpaid_review_count / unpaid_review_count) * 100\n","print(f'Of of the paid reviews, {paid_percent_five_review: .2f}% are 5 Star. Of the unpaid reviews, {unpaid_percent_five_review: .2f}% are 5 Star.')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"vhdMC7_RbkzU","executionInfo":{"status":"ok","timestamp":1645147523919,"user_tz":360,"elapsed":119,"user":{"displayName":"John Johnson","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhstUkqtfEw5JoEhfpH0QisWPDpqPm_xx1h5ha0hg=s64","userId":"10615251833365899961"}},"outputId":"9dab1b0b-0de1-4798-f587-fd1fd5688b81"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Of of the paid reviews,  36.41% are 5 Star. Of the unpaid reviews,  47.17% are 5 Star.\n"]}]}],"metadata":{"colab":{"collapsed_sections":[],"name":"Vine_Review_Analysis","provenance":[{"file_id":"1R-LET-z1Eqx0T5F8akuoFVdt1KqjgTxY","timestamp":1645146085169},{"file_id":"/v2/external/notebooks/welcome.ipynb","timestamp":1645141542523}]},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}